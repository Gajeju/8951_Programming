#include <AT89x51.h>

unsigned char index1 = 0;
unsigned char index2 = 0;
unsigned char index3 = 0;

unsigned long time[4] = {0, 1, 2, 3};
unsigned long temp[4];

void delay(unsigned int i)
{
    while(i--);
}

unsigned char pow(unsigned char a)
{
    unsigned char i;
    unsigned char result = 1;
    
    for (i = 0; i < a; i++)
    {
        result *= 2;
    }
    return result;
}

void choose(void)
{

    unsigned long m;
    unsigned char i,j;
    
    //배열 복사
    for (i = 0; i < 3; i++)
    {
    temp[i] = time[i];
    }
    
    //오름차순 정렬
    for (i = 0; i < 3; i++)
    {
    for (j = 0; j < j-(i+1); j++ )
    if (temp[j] >= temp[j+1])
    {
    m = temp[j+1];
    temp[j+1] = temp[j];
    temp[j] = m;
    }
    }

    //index값 설정
    for (i = 0; i < 3; i++)
    {
    if (time[i] == temp[0]) index1 = i;
    if (time[i] == temp[1]) index2 = i;
    if (time[i] == temp[2]) index3 = i;
    }
}

void main(void)
{
    unsigned char sw = 0;

    while(1)
    {
        P1 = 0xff;
        sw = P1;


      //스위치에 따른 출력
      if (sw == 0xfe)
      {
        choose();
        P2 = 0xff - pow(index1);
        time[index1] += 1;
        delay(1000);

      }
      else if (sw == 0xfd)
      {

      }
      else if (sw == 0xfb)
      {


      }
      else if (sw == 0xf7)
      {
        P2 = 0xf0;
        delay(100);
      }
        P2 = 0xff;
    }
}
